<ul class="main-nav">
  {% assign roots = site.pages | where:"parent", nil | sort:"nav_order" %}
  {% for p in roots %}
    <li>
      <a href="{{ p.url }}">{{ p.title }}</a>
      {% assign children = site.pages | where:"parent", p.slug | sort:"nav_order" %}
      {% if children %}
        <ul class="sub-nav">
          {% for c in children %}
            <li><a href="{{ c.url }}">{{ c.title }}</a></li>
          {% endfor %}
        </ul>
      {% endif %}
    </li>
  {% endfor %}
</ul>
